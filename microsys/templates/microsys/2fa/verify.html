{% extends 'microsys/base.html' %}
{% load static %}
{% block title %}{{ MS_TRANS.2fa_verify_title }}{% endblock %}
{% block extra_head %}
<link rel="stylesheet" href="{% static 'microsys/users/css/login.css' %}">
{% endblock %}
{% block titlebar %}{% endblock %}

{% block layout %}
<div class="page">
    {% if messages %}
        <div class="alert-container position-absolute top-0 start-0 w-100" style="z-index: 2000;">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} text-center h4" style="opacity: 95%;">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <div class="container">
      <div class="left">
        <div class="d-flex flex-column align-items-center mb-4 d-md-none">
            <div class="logo-frame">
                <img src="{% static 'img/login_logo.webp' %}" alt="Login Logo" class="logo-img">
            </div>
        </div>
        <form method="post" action="" class="w-100">
            {% csrf_token %}
            
            <div class="form m-0 mx-auto text-center">
                <h3 class="mb-3 text-white">{{ MS_TRANS.2fa_verify_title }}</h3>
                <p class="text-white-50 mb-4">{{ MS_TRANS.2fa_verify_desc }}</p>

                {% if error_message %}
                    <div class="alert alert-danger" role="alert">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i> {{ error_message }}
                    </div>
                {% endif %}

                <div class="mb-4">
                    <label for="otp_code" class="visually-hidden">{{ MS_TRANS.2fa_code }}</label>
                    <input type="text" 
                           class="login-input text-center fw-bold" 
                           id="otp_code" 
                           name="otp_code" 
                           placeholder="######" 
                           maxlength="6" 
                           autofocus 
                           required
                           style="letter-spacing: 0.5em; font-size: 1.5rem;">
                </div>
        
                <button type="submit" class="w-100 btn btn-lg mt-4" id="submit">{{ MS_TRANS.2fa_verify_btn }}</button>
                
                <div class="d-flex justify-content-between mt-4">
                    {% if intent == 'login' %}
                        <a href="{% url 'resend_otp_login' %}" class="text-white-50 text-decoration-none small">{{ MS_TRANS.2fa_resend_btn }}</a>
                        <a href="{% url 'login' %}" class="text-white-50 text-decoration-none small">Back to Login</a>
                    {% else %}
                        <a href="{% url 'resend_otp_enable' %}" class="text-white-50 text-decoration-none small">{{ MS_TRANS.2fa_resend_btn }}</a>
                        <a href="{% url 'user_profile' %}" class="text-white-50 text-decoration-none small">Cancel</a>
                    {% endif %}
                </div>
            </div>
        </form>
      </div>
      
      <div class="right d-none d-md-flex">
          <div class="logo-frame">
            <img src="{% static 'img/login_logo.webp' %}" alt="Login Logo" class="logo-img">
          </div>
      </div>
    </div>
</div>
{% endblock %}
